{% extends 'base.html' %}

{% block title %}TIENDA AVILA'S - Productos{% endblock %}

{% block content %}
    <main>
        <h1>Resultados de la Consulta</h1>
        {% if success %}
            <p>{{ mensaje }} (Mostrados: {{ total_mostrados }})</p>
            <p>Consulta realizada: {{ consulta }}</p>
            <div class="products-controls">
                <div class="products-count">Mostrando {{ total_mostrados }} productos</div>
            </div>
            <div class="card-container">
                {% for producto in productos %}
                    <div class="card mx-auto">
                        <div class="card-img-container">
                            {% if producto.images and producto.images.0 %}
                                <img src="{{ producto.images.0 }}" alt="{{ producto.title }}" class="card-img" onerror="this.src='https://via.placeholder.com/280x200';">
                            {% else %}
                                <img src="https://via.placeholder.com/280x200" alt="Placeholder" class="card-img">
                            {% endif %}
                        </div>
                        <div class="card-content text-center">
                            <span class="card-id">#{{ producto.id }}</span>
                            <h3>{{ producto.title }}</h3>
                            <p class="price">${{ producto.price }}</p>
                            <p class="description">{{ producto.description|truncatewords:20 }}</p>
                        </div>
                        <div class="card-action">
                            <button class="btn d-block mx-auto">Ver Detalles</button>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="error-message text-center">
                {{ mensaje }}
            </div>
        {% endif %}
    </main>
{% endblock %}